MAGIC QUERY
SELECT 
	MAX(ARICREATEDTTM) LastOperationDate, 
	ARISERVICECODE Service, 
	IIF(ARIOPERATIONCODE like 'Resp%','Resp', 'Send') Operation
FROM ARCHIVEITEM
WHERE 
	ARICREATEDTTM >= DATEADD(DAY,-1, GETDATE()) and ARISTATUS = 'OK'
GROUP BY ARISERVICECODE, IIF(ARIOPERATIONCODE like 'Resp%','Resp', 'Send')
ORDER BY 2, 3


SELECT 
	MAX(ARICREATEDTTM) LastOperationDate, 
	ARISERVICECODE Service, 
	ARIOPERATIONCODE Operation
FROM ARCHIVEITEM
WHERE 
	ARICREATEDTTM >= DATEADD(DAY,-1, GETDATE())
	AND ARIOPERATIONCODE IN ('Resp', 'Send')
GROUP BY ARISERVICECODE, ARIOPERATIONCODE
ORDER BY ARISERVICECODE, ARIOPERATIONCODE

==
select distinct([service]) from (
SELECT 
	MAX(ARICREATEDTTM) LastOperationDate, 
	ARISERVICECODE Service, 
	IIF(ARIOPERATIONCODE like 'Resp%','Resp', 'Send') Operation
FROM ARCHIVEITEM
WHERE 
	ARICREATEDTTM >= DATEADD(DAY,-1, GETDATE()) and ARISTATUS = 'OK'
GROUP BY ARISERVICECODE, IIF(ARIOPERATIONCODE like 'Resp%','Resp', 'Send') ) b where [Service] is not null
ORDER BY 2, 3